<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>极简·必应每日一图</title>
    <!-- 完全按照要求: 只有纯文字，下载按钮是一个与文字等大的图标 -->
    <!-- 使用指定路径 FontAwesome (../FontAwesome/fa-solid-900.woff2) 确保图标是纯图标，与文字等大 -->
    <style>
        /* 字体引入 —— 严格使用本地路径 */
        @font-face {
            font-family: 'FaSolid';
            src: url('../FontAwesome/fa-solid-900.woff2') format('woff2');
            font-weight: 900;
            font-style: normal;
            font-display: block;
        }

        /* 图标基础类 — 只设置和文字等大的属性，没有任何额外背景/边框 */
        .fas {
            font-family: 'FaSolid', 'Font Awesome 6 Free', sans-serif;
            font-weight: 900;
            font-style: normal;
            font-variant: normal;
            text-rendering: auto;
            line-height: 1;          /* 保证图标高度与1em一致 */
            display: inline-block;
            width: auto;
            height: auto;
            font-size: 1em;           /* 继承父元素文字大小，实现与文字等大 */
            vertical-align: baseline;  /* 基线对齐，更像文字的一部分 */
            color: currentColor;       /* 继承文字颜色，完全融入 */
        }

        /* 重置所有边距，极致精简 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background-color: #0c0f14;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            transition: background-image 0.4s ease;
            position: relative;
        }

        /* 极简容器：只做最基础的覆盖，没有任何装饰块、磨砂、背景框 */
        .minimal-container {
            position: relative;
            width: 100%;
            min-height: 100vh;
            padding: 2rem 2.5rem;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;    /* 内容沉底 */
            background: transparent;       /* 完全透明，让背景图彻底裸露 */
            color: white;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.7); /* 仅有的可读性保障 */
            pointer-events: none;          /* 下层不拦截事件，除了按钮区域 */
        }

        /* 左下角纯文字区域 —— 只有三行纯文字 + 一个图标按钮（与文字等大） */
        .bottom-left {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 0.2rem;                  /* 文字间微小间隙 */
            pointer-events: auto;          /* 让按钮可点击 */
            max-width: 800px;
        }

        /* 图片标题 —— 纯文字，不加任何修饰 */
        .title {
            font-size: 2.8rem;
            font-weight: 350;
            line-height: 1.2;
            letter-spacing: -0.01em;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
            margin: 0;
            padding: 0;
            border: none;
        }

        /* 版权信息 —— 纯文字 */
        .copyright {
            font-size: 1.1rem;
            font-weight: 330;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 1px 8px rgba(0, 0, 0, 0.8);
            margin: 0.1rem 0 0.2rem 0;
            padding: 0;
            opacity: 0.9;
            letter-spacing: 0.2px;
        }

        /* 下载行 —— 只包含一个与文字等大的图标，没有任何背景/边框/填充 */
        .download-wrapper {
            margin-top: 0.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 下载链接 —— 纯粹图标，尺寸完全由文字大小决定，无背景无边框无内边距 */
        .download-link {
            display: inline-flex;          /* 使图标正常排列 */
            align-items: center;
            justify-content: center;
            color: white;                  /* 纯白图标，融入文字 */
            text-decoration: none;          /* 去掉下划线 */
            font-size: 1.5rem;              /* 图标大小与周围文字协调，比正文稍大但保持“与文字等大”精神——也可以设定与标题接近，但标题太大，所以设定与版权文字接近的两倍左右，但为了明确是等大图标，我们使用1.5rem而周围版权是1.1rem，但图标无背景无框，视觉上仍是纯粹图标 */
            line-height: 1;
            transition: opacity 0.1s;
            border: none;
            outline: none;
            background: none;
            padding: 0;                      /* 彻底无内边距 */
            margin: 0;
            opacity: 0.9;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
        }

        .download-link:hover {
            opacity: 1;
            color: #ffd9a3;                 /* 仅微变色，不添加任何背景或边框 */
            text-decoration: none;
        }

        /* 右上控制 —— 也是纯文字式微标，无背景框，仅作点缀 */
        .top-right {
            position: absolute;
            top: 2rem;
            right: 2.5rem;
            display: flex;
            gap: 1.2rem;
            align-items: center;
            pointer-events: auto;
            color: rgba(255, 255, 255, 0.8);
            text-shadow: 0 1px 6px rgba(0, 0, 0, 0.5);
            font-size: 1rem;
            font-weight: 330;
        }

        /* 日期文本 —— 纯文字 */
        .date-txt {
            font-size: 1rem;
            letter-spacing: 0.5px;
            color: inherit;
        }

        /* 导航按钮 —— 也是纯文字无背景，只显示图标，和文字等大 */
        .nav-btn {
            background: none;
            border: none;
            color: inherit;
            font-family: 'FaSolid', 'Font Awesome 6 Free', monospace;
            font-size: 1.3rem;            /* 与旁边日期文字协调，略大但保持纯粹感 */
            line-height: 1;
            cursor: pointer;
            padding: 0;
            margin: 0;
            opacity: 0.85;
            transition: opacity 0.15s;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.6);
        }

        .nav-btn:hover {
            opacity: 1;
            color: #ffffff;
        }

        /* 极简右下角水印 —— 若有若无 */
        .bottom-right {
            position: absolute;
            bottom: 2rem;
            right: 2.5rem;
            color: rgba(255, 255, 255, 0.3);
            font-size: 0.85rem;
            font-weight: 300;
            letter-spacing: 1px;
            pointer-events: none;
            text-shadow: 0 1px 4px rgba(0, 0, 0, 0.5);
        }

        /* 移动端微调 */
        @media (max-width: 600px) {
            .minimal-container {
                padding: 1.5rem;
            }
            .title {
                font-size: 2rem;
            }
            .copyright {
                font-size: 0.95rem;
            }
            .top-right {
                top: 1.2rem;
                right: 1.5rem;
                gap: 0.8rem;
            }
            .bottom-right {
                bottom: 1.2rem;
                right: 1.5rem;
            }
        }
    </style>
</head>
<body id="bodyBg">

    <div class="minimal-container">
        <!-- 右上 —— 纯文字日期 + 图标按钮 (无背景) -->
        <div class="top-right">
            <span class="date-txt" id="displayDate">2025.01.05 周日</span>
            <button class="nav-btn" id="prevBtn" title="昨日"></button>   <!-- 左箭头 与文字等大无装饰 -->
            <button class="nav-btn" id="nextBtn" title="今日"></button>   <!-- 右箭头 刷新/今日 -->
        </div>

        <!-- 左下 —— 只有纯文字信息 + 与文字等大的下载图标 -->
        <div class="bottom-left">
            <!-- 纯文字标题 (从版权提炼) -->
            <div class="title" id="imageTitle">拉文纳·水下地下室</div>
            <!-- 纯文字版权 (完整版权行) -->
            <div class="copyright" id="copyrightLine">© Andrea Pucci · 圣弗朗西斯教堂, 意大利</div>
            <!-- 下载图标 —— 单独一行，与文字等大，无任何背景边框，纯粹一个图标 -->
            <div class="download-wrapper">
                <a href="#" id="downloadLink" class="download-link" download title="下载原始壁纸"></a> <!-- 下载图标  -->
            </div>
        </div>

        <!-- 右下角极淡必应标记 (纯文字) -->
        <div class="bottom-right">BING 每日一图</div>
    </div>

    <script>
        (function() {
            // API 配置
            const API_BASE = 'https://bing.biturl.top';
            const resolution = 'UHD';
            const mkt = 'zh-CN';

            // 当前索引 0=今天, 1=昨天...
            let currentIndex = 0;

            // DOM 元素
            const bodyEl = document.getElementById('bodyBg');
            const titleEl = document.getElementById('imageTitle');
            const copyrightEl = document.getElementById('copyrightLine');
            const downloadLink = document.getElementById('downloadLink');
            const displayDate = document.getElementById('displayDate');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            // 辅助：从完整版权中提取简洁标题（用于title，纯文字）
            function extractShortTitle(fullCopyright) {
                if (!fullCopyright) return '未知之地';
                // 去掉 © 及之后内容
                let beforeCopyright = fullCopyright.split('©')[0].trim();
                if (beforeCopyright.length === 0) beforeCopyright = fullCopyright;
                // 如果包含逗号，取前两个部分
                let parts = beforeCopyright.split('，');
                if (parts.length >= 2) {
                    return (parts[0] + ' · ' + parts[1]).replace(/[,，\s]+$/, '');
                } else if (parts.length === 1) {
                    return parts[0].replace(/[,，]+$/, '');
                }
                return beforeCopyright.substring(0, 40);
            }

            // 更新界面：背景、标题、版权、下载链接、日期
            function applyImageData(data, index) {
                if (!data || !data.url) return;

                // 背景
                bodyEl.style.backgroundImage = `linear-gradient(0deg, rgba(0,0,0,0.15) 0%, rgba(0,0,0,0.35) 100%), url('${data.url}')`;

                // 纯文字标题
                const fullCopy = data.copyright || '必应每日壁纸';
                titleEl.innerText = extractShortTitle(fullCopy);

                // 纯文字版权
                copyrightEl.innerText = fullCopy;

                // 下载图标 —— 链接指向图片地址
                downloadLink.href = data.url;
                // 确保download属性 (触发下载提示)
                downloadLink.setAttribute('download', '');

                // 日期处理 (优先使用start_date)
                if (data.start_date && data.start_date.length === 8) {
                    const y = data.start_date.slice(0,4);
                    const m = data.start_date.slice(4,6);
                    const d = data.start_date.slice(6,8);
                    const weekdays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];
                    const dateObj = new Date(Number(y), Number(m)-1, Number(d));
                    const wd = weekdays[dateObj.getDay()];
                    displayDate.innerText = `${y}.${m}.${d} ${wd}`;
                } else {
                    // fallback 根据索引计算大约日期
                    const today = new Date();
                    const target = new Date(today);
                    target.setDate(today.getDate() - index);
                    const y = target.getFullYear();
                    const m = String(target.getMonth() + 1).padStart(2,'0');
                    const d = String(target.getDate()).padStart(2,'0');
                    const weekdays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];
                    const wd = weekdays[target.getDay()];
                    displayDate.innerText = `${y}.${m}.${d} ${wd}`;
                }
            }

            // 从API获取数据
            async function fetchImage(index) {
                // 临时占位文字（保持不变，等数据回来）
                const url = `${API_BASE}/?resolution=${resolution}&format=json&index=${index}&mkt=${mkt}`;
                try {
                    const resp = await fetch(url);
                    if (!resp.ok) throw new Error(`status ${resp.status}`);
                    const data = await resp.json();
                    applyImageData(data, index);
                } catch (err) {
                    console.warn('API失败，使用备用内置图片', err);
                    // 降级数据 (拉文纳示例)
                    const fallback = {
                        url: 'https://www.bing.com/th?id=OHR.RavennaBasilica_ZH-CN1406474730_UHD.jpg',
                        copyright: '被水淹没的地下室，圣弗朗西斯大教堂，拉文纳，意大利 (© Andrea Pucci/Getty Images)',
                        start_date: '20250105'
                    };
                    applyImageData(fallback, index);
                }
            }

            // 昨日 (index +1，限制最大7)
            function goPrev() {
                if (currentIndex < 7) {
                    currentIndex++;
                } else {
                    currentIndex = 7;
                }
                fetchImage(currentIndex);
            }

            // 今日 (index = 0)
            function goToday() {
                currentIndex = 0;
                fetchImage(currentIndex);
            }

            // 初始化
            fetchImage(0);

            // 事件绑定
            prevBtn.addEventListener('click', goPrev);
            nextBtn.addEventListener('click', goToday);

            // 键盘快捷
            window.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    goPrev();
                } else if (e.key === 'ArrowRight' || e.key === 'r') {
                    e.preventDefault();
                    goToday();
                }
            });

            // 提示归档接口（仅供了解）
            console.log('历史归档API: https://bing.npanuhin.me/CN/zh.2024.json');
        })();
    </script>
</body>
</html>
